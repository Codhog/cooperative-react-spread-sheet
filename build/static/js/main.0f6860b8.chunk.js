(this["webpackJsonpreact-spread-sheet"]=this["webpackJsonpreact-spread-sheet"]||[]).push([[0],{42:function(e,t,n){},75:function(e,t,n){},76:function(e,t,n){"use strict";n.r(t);var a=n(1),s=n.n(a),i=n(35),l=n.n(i),r=(n(42),n(8)),o=n(9),c=n(11),d=n(10),u=n(37),p=n(36),h=n.n(p)()("ws://localhost:8080",{transports:["websocket"]}),y=n(0),v=function(e){Object(c.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).onChange=function(e){a.setState({value:e.target.value}),a.display=a.determineDisplay({x:a.props.x,y:a.props.y},e.target.value)},a.onKeyPressOnInput=function(e){"Enter"===e.key&&a.hasNewValue(e.target.value)},a.onKeyPressOnSpan=function(){a.state.editing||a.setState({editing:!0})},a.onBlur=function(e){h.emit("editend",{xycoor:[a.props.x,a.props.y],newValue:e.target.value,name:a.props.displayName}),a.hasNewValue(e.target.value)},a.handleUnselectAll=function(){(a.state.selected||a.state.editing)&&a.setState({selected:!1,editing:!1})},a.hasNewValue=function(e){a.props.onChangedValue({x:a.props.x,y:a.props.y},e),a.setState({editing:!1}),a.props.updateCells()},a.emitUnselectAllEvent=function(){var e=new Event("unselectAll");window.document.dispatchEvent(e)},a.clicked=function(){a.emitUnselectAllEvent(),a.timer=setTimeout((function(){a.prevent||(a.emitUnselectAllEvent(),a.setState({selected:!0})),a.prevent=!1}),a.delay)},a.doubleClicked=function(){clearTimeout(a.timer),a.prevent=!0,a.emitUnselectAllEvent(),a.setState({selected:!0,currentXy:[a.props.x,a.props.y],typingName:a.props.displayName}),h.emit("skediting",{dataName:a.props.displayName,dataCoor:[a.props.x,a.props.y]})},a.determineDisplay=function(e,t){e.x,e.y;return t},a.calculateCss=function(){var e={width:"80px",padding:"4px",margin:"0",height:"25px",boxSizing:"border-box",position:"relative",display:"inline-block",color:"black",border:"1px solid #cacaca",textAlign:"left",verticalAlign:"top",fontSize:"14px",lineHeight:"15px",overflow:"hidden",fontFamily:"Calibri, 'Segoe UI', Thonburi,Arial, Verdana, sans-serif"};return 0!==a.props.x&&0!==a.props.y||(e.textAlign="center",e.backgroundColor="#f0f0f0",e.fontWeight="bold"),e},a.state={editing:!1,selected:!1,value:e.value,typingName:"",currentXy:[]},a.display=a.determineDisplay({x:e.x,y:e.y},e.value),a.timer=0,a.delay=200,a.prevent=!1,a}return Object(o.a)(n,[{key:"componentDidMount",value:function(){var e=this;h.on("skeditcoming",(function(t){e.emitUnselectAllEvent(),e.setState({typingName:t.dataName,currentXy:Object(u.a)(t.dataCoor),editing:!0})})),h.on("editendcoming",(function(t){window.document.addEventListener("unselectAll",e.handleUnselectAll),e.setState({typingName:"",currentXy:[],editing:!1})}))}},{key:"componentWillUnmount",value:function(){window.document.removeEventListener("unselectAll",this.handleUnselectAll)}},{key:"shouldComponentUpdate",value:function(e,t){return""!==this.state.value||(t.value!==this.state.value||t.editing!==this.state.editing||t.selected!==this.state.selected||e.value!==this.props.value)}},{key:"render",value:function(){var e=this,t=this.calculateCss(),n=this.state,a=n.selected,s=n.currentXy,i=n.typingName,l=n.value;n.otherEditing;if(0===this.props.x)return Object(y.jsx)("span",{style:t,children:this.props.y});if(0===this.props.y){var r=" abcdefghijklmnopqrstuvwxyz".split("");return Object(y.jsx)("span",{onKeyPress:this.onKeyPressOnSpan,style:t,role:"presentation",children:r[this.props.x]})}return a&&(t.outlineColor="lightblue",t.outlineStyle="dotted"),s.length>0&&this.props.x===s[0]&&this.props.y===s[1]?Object(y.jsx)(y.Fragment,{children:Object(y.jsx)("input",{style:t,type:"text",onBlur:this.onBlur,onKeyPress:this.onKeyPressOnInput,value:l,onChange:this.onChange,placeholder:i+" is typing",autoFocus:!0})}):Object(y.jsx)("span",{onClick:function(t){return e.clicked(t)},onDoubleClick:function(t){return e.doubleClicked(t)},style:t,role:"presentation",children:this.state.value})}}],[{key:"getDerivedStateFromProps",value:function(e,t){var n=e.value;return n.length>0?{editing:!0,value:n}:null}}]),n}(s.a.Component),g=function(e){for(var t=[],n=e.y,a=0;a<e.x;a+=1)t.push(Object(y.jsx)(v,{y:n,x:a,onChangedValue:e.handleChangedCell,updateCells:e.updateCells,value:e.rowData[a]||"",displayName:e.displayName},"".concat(a,"-").concat(n)));return Object(y.jsx)("div",{children:t})},m=function(e){Object(c.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).handleChangedCell=function(e,t){var n=e.x,s=e.y,i=Object.assign({},a.state.data);i[s]||(i[s]={}),i[s][n]=t,a.setState({data:i}),a.sendMessage(i,a.props.displayName)},a.editEndChangedCell=function(e,t){var n=e.x,s=e.y,i=Object.assign({},a.state.data);i[s]||(i[s]={}),i[s][n]=t,a.setState({data:i}),a.forceUpdate()},a.sendMessage=function(e,t){h.emit("skchange",{data:e,sender:t})},a.updateCells=function(){a.forceUpdate()},a.state={data:{},displayName:e.displayName,sender:""},a}return Object(o.a)(n,[{key:"componentDidMount",value:function(){var e=this;h.on("sknew",(function(t){e.setState({data:t.data,sender:t.sender}),e.forceUpdate()})),h.on("editendcoming",(function(t){var n=[t.xycoor[0],t.xycoor[1]],a=n[0],s=n[1];e.editEndChangedCell({x:a,y:s},t.newValue)}))}},{key:"render",value:function(){for(var e=[],t=0;t<this.props.y+1;t+=1){var n=this.state.data[t]||{};e.push(Object(y.jsx)(g,{handleChangedCell:this.handleChangedCell,updateCells:this.updateCells,y:t,x:this.props.x+1,rowData:n,displayName:this.props.displayName},t))}return Object(y.jsx)("div",{children:e})}}]),n}(s.a.Component),f=(n(75),function(e){Object(c.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).handleLogin=function(){h.emit("getID",a.username.current.value),a.setState({displayTable:!0})},a.username=s.a.createRef(),a.state={displayTable:!1},a}return Object(o.a)(n,[{key:"render",value:function(){return this.username.current,this.state.displayTable?Object(y.jsx)("div",{style:{width:"max-content"},children:Object(y.jsx)(m,{x:4,y:4,displayName:this.username.current.value})}):Object(y.jsxs)("div",{className:"box",children:[Object(y.jsx)("h1",{children:"Cooperative Editing Sheet"}),Object(y.jsx)("input",{type:"text",placeholder:"Please type username",ref:this.username}),Object(y.jsx)("button",{style:{marginTop:"20px",padding:"10px"},type:"submit",onClick:this.handleLogin,children:"Enter"})]})}}]),n}(s.a.Component)),x=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,77)).then((function(t){var n=t.getCLS,a=t.getFID,s=t.getFCP,i=t.getLCP,l=t.getTTFB;n(e),a(e),s(e),i(e),l(e)}))};l.a.render(Object(y.jsx)(s.a.StrictMode,{children:Object(y.jsx)(f,{})}),document.getElementById("root")),x()}},[[76,1,2]]]);
//# sourceMappingURL=main.0f6860b8.chunk.js.map